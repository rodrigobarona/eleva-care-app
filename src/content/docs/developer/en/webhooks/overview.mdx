---
title: Webhooks Overview
description: Receive real-time notifications for events in the Eleva Care platform via webhooks.
---

# Webhooks Overview

Webhooks allow you to receive real-time notifications when events occur in Eleva Care. Instead of polling the API for updates, webhooks push data to your application as events happen.

## How Webhooks Work

```
1. Event occurs in Eleva Care (e.g., booking confirmed)
2. Eleva Care sends HTTP POST to your webhook URL
3. Your server processes the event
4. You return 200 OK to acknowledge receipt
```

## Setting Up Webhooks

### 1. Create a Webhook Endpoint

Create an endpoint in your application to receive webhook events:

```typescript
// Example: Express.js
app.post('/webhooks/eleva', express.raw({ type: 'application/json' }), (req, res) => {
  const signature = req.headers['x-eleva-signature'];
  const payload = req.body;

  // Verify signature
  if (!verifySignature(payload, signature, WEBHOOK_SECRET)) {
    return res.status(401).send('Invalid signature');
  }

  const event = JSON.parse(payload);
  
  // Process event
  switch (event.type) {
    case 'booking.confirmed':
      handleBookingConfirmed(event.data);
      break;
    case 'payment.succeeded':
      handlePaymentSucceeded(event.data);
      break;
  }

  res.status(200).json({ received: true });
});
```

### 2. Register Your Webhook

Register your webhook in the Partner Dashboard or via API:

**Via Dashboard:**

1. Go to **Settings** → **Webhooks**
2. Click **Add Webhook**
3. Enter your endpoint URL
4. Select events to subscribe to
5. Copy the signing secret

**Via API:**

```bash
curl -X POST "https://api.eleva.care/v1/webhooks" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://yourapp.com/webhooks/eleva",
    "events": ["booking.confirmed", "payment.succeeded"],
    "active": true
  }'
```

### 3. Verify Signatures

Always verify webhook signatures to ensure authenticity:

```typescript
import crypto from 'crypto';

function verifySignature(
  payload: string,
  signature: string,
  secret: string
): boolean {
  const timestamp = signature.split(',')[0].split('=')[1];
  const receivedSignature = signature.split(',')[1].split('=')[1];
  
  const signedPayload = `${timestamp}.${payload}`;
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(signedPayload)
    .digest('hex');

  // Use timing-safe comparison
  return crypto.timingSafeEqual(
    Buffer.from(receivedSignature),
    Buffer.from(expectedSignature)
  );
}
```

## Webhook Payload

All webhook payloads follow this structure:

```json
{
  "id": "evt_abc123",
  "type": "booking.confirmed",
  "created": "2024-01-15T10:30:00Z",
  "data": {
    // Event-specific data
  },
  "organization": {
    "id": "org_xyz789",
    "name": "Your Organization"
  }
}
```

## Signature Header

Each webhook includes a signature header:

```
X-Eleva-Signature: t=1673784600,v1=5257a869e7ecebeda32affa62cdca3fa51cad7e77a0e56ff536d0ce8e108d8bd
```

Components:
- `t`: Unix timestamp when the request was sent
- `v1`: HMAC SHA-256 signature

## Best Practices

### 1. Respond Quickly

Return a 200 response as quickly as possible. Process events asynchronously:

```typescript
app.post('/webhooks/eleva', async (req, res) => {
  // Immediately acknowledge receipt
  res.status(200).json({ received: true });
  
  // Process asynchronously
  processEventAsync(req.body).catch(console.error);
});
```

### 2. Handle Duplicates

Webhooks may be sent multiple times. Use the event ID for idempotency:

```typescript
async function processEvent(event: WebhookEvent) {
  // Check if already processed
  const processed = await db.processedEvents.findOne({ eventId: event.id });
  if (processed) {
    return; // Skip duplicate
  }
  
  // Process event
  await handleEvent(event);
  
  // Mark as processed
  await db.processedEvents.create({ eventId: event.id });
}
```

### 3. Verify Timestamps

Reject old webhooks to prevent replay attacks:

```typescript
const MAX_AGE_SECONDS = 300; // 5 minutes

function isTimestampValid(timestamp: number): boolean {
  const now = Math.floor(Date.now() / 1000);
  return Math.abs(now - timestamp) < MAX_AGE_SECONDS;
}
```

### 4. Use HTTPS

Always use HTTPS endpoints for security.

### 5. Log Everything

Log all webhook events for debugging:

```typescript
function logWebhook(event: WebhookEvent, status: 'success' | 'error') {
  console.log({
    eventId: event.id,
    eventType: event.type,
    status,
    timestamp: new Date().toISOString(),
  });
}
```

## Retry Policy

If your endpoint fails, Eleva Care retries with exponential backoff:

| Attempt | Delay |
|---------|-------|
| 1 | Immediate |
| 2 | 1 minute |
| 3 | 5 minutes |
| 4 | 30 minutes |
| 5 | 2 hours |
| 6 | 24 hours |

After 6 failed attempts, the webhook is marked as failed.

## Testing Webhooks

### Webhook Logs

View webhook delivery logs:

**Partner Dashboard** → **Settings** → **Webhooks** → **Logs**

### Test Events

Send test events to your endpoint:

```bash
curl -X POST "https://api.eleva.care/v1/webhooks/test" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "webhookId": "wh_abc123",
    "eventType": "booking.confirmed"
  }'
```

### Local Development

Use tunneling tools for local testing:

```bash
# Using ngrok
ngrok http 3000

# Register the ngrok URL as your webhook endpoint
# https://abc123.ngrok.io/webhooks/eleva
```

## Debugging

### Common Issues

| Issue | Solution |
|-------|----------|
| Signature mismatch | Ensure you're using the raw request body |
| Timeout errors | Return 200 quickly, process async |
| Missing events | Check your event subscription |
| Duplicate events | Implement idempotency |

### Webhook Debugging Checklist

- [ ] Endpoint returns 200 for valid requests
- [ ] Signature verification is correct
- [ ] Using raw request body for signature
- [ ] Processing events asynchronously
- [ ] Handling duplicate events
- [ ] Logging all events

## Next Steps

<Cards>
  <Card title="Webhook Events" href="/docs/developer/webhooks/events">
    See all available webhook events
  </Card>
  <Card title="Integrations" href="/docs/developer/integrations/stripe">
    Learn about third-party integrations
  </Card>
</Cards>


